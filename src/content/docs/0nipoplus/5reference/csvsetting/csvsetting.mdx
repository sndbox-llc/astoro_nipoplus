---
slug: nipoplus/reference/csvsettings
title: CSV出力の設定
description: 日報データをCSV出力する際の、列の展開方法やその他の詳細設定が可能です。CSVの使用用途に応じて設定を変更することで加工の手間を削減できます
sidebar:
  label: ⚙️CSV出力の設定
---

import ExcelTable from '@components/ExcelTable.astro'

日報に記録されたデータをCSV形式で出力する際に、出力の形式を細かくカスタマイズできます。
CSVファイルは、Excelでの詳細な分析、他のシステムへのデータインポート、または長期的なデータバックアップなど、様々な用途で活用できます。
出力設定は「CSV出力」ボタンの隣りにある「▼」ボタンから行えます。設定の内容は自動で保存されます。

![CSV出力のオプション設定はON/OFFの切り替えで簡単に設定可能](./img/csv-setting1_tablet.png)

## 主たる設定項目

以下に、CSV出力に関するその他の設定項目をまとめて記載します

<dl class="basic">
<dt>列の展開</dt>
<dd>１つのデータに対して複数列を使用して出力します。詳細は下記の「<a href="#splead">列の展開について</a>」を参照してください</dd>
<dt>行列を入れかえる</dt>
<dd>
  <ul>
    <li>OFF：1行に1つの日報のデータを表示します（推奨）</li>
    <li>ON：1列に1つの日報のデータを表示します</li>
  </ul>
</dd>

<dt>日付の古い順に出力する</dt>
<dd>
  <ul>
    <li>OFF：日報の日付が新しい順に出力されます</li>
    <li>ON：日報の日付が古い順に出力されます</li>
  </ul>
</dd>

<dt>写真・ファイル等を出力</dt>
<dd>
  <a href="/nipoplus/template/binarys/#picture">写真入力フォーム</a>、<a href="/nipoplus/template/binarys/#sign">署名入力フォーム</a>、<a href="/nipoplus/template/binarys/#file">ファイル入力フォーム</a>で添付されたデータをCSVファイルとは別のフォルダにまとめて出力します。また、ダウンロード形式がZIPに変化します
</dd>

<dt>コメントを出力</dt>
<dd>
  日報に書き込まれた<a href="/nipoplus/staff/readreport/#comment">コメント</a>をCSVファイルに含めます
</dd>

<dt>提出日を出力</dt>
<dd>日報の提出日時をCSVファイルに含めます。日報作成者が指定した日付です</dd>

<dt>【可変-提出日】同日報の2行目以降も出力</dt>
<dd>
  <ul>
    <li>
      ON：<a href="/nipoplus/template/array/">反復入力フォーム</a>を使用している日報で、2行目以降のデータにも日付を重複して出力します。
    </li>
    <li>OFF：反復入力の2行目以降は日付を省略します。</li>
  </ul>
  <a href="/nipoplus/template/array/">反復入力</a>がないテンプレートではこの設定は意味が有りません
</dd>

<dt>提出者IDを出力</dt>
<dd>日報を作成したスタッフのシステム内部IDを出力します</dd>

<dt>提出者名を出力</dt>
<dd>日報を作成したスタッフ名を出力します</dd>

<dt>状態を出力</dt>
<dd>
  <a href="/nipoplus/reference/reportstate/">日報の現在の状態</a>をCSVに含めます
</dd>

<dt>URLを出力</dt>
<dd>出力元の日報のURLをCSVファイルに含めます</dd>

<dt>
  <a href="/nipoplus/reference/reportstate/#agree">承認者名を出力</a>
</dt>
<dd>
  日報を承認するスタッフの名前と、承認・棄却の状態を出力します。<a href="/nipoplus/reference/reportstate/#relay">承認者が複数人いる場合</a>は、人数分列が追加されて出力されます
</dd>

<dt>文書IDを出力</dt>
<dd>日報固有のIDを出力します</dd>

<dt>文書番号を出力</dt>
<dd>日報に自動で割り振られる連番を出力します</dd>
</dl>

<hr id="splead" />

## 列の展開について

列はCSVにおける縦方向のデータです。１つのデータに対して１列で表現するか、複数列で表現するかを選択できます。
文字だけではわかりにくいため、以下に同じ日報を列展開ON/OFFで出力した例を記載します。

:::note[OSという選択入力フォームに注目]
選択肢は「Windows」「Mac」「Android」「iOS」の4つとします。列展開がONだと4列、OFFだと1列で出力されます
:::

### 列展開をONにして出力した例

{/* prettier-ignore */}
<ExcelTable>
日付, 【OS】Windows, 【OS】Mac, 【OS】Android, 【OS】iOS
2022/01/01, ⭕, -, -, -
2022/01/02, -, ⭕, -, -
2023/01/03, -, -, -, ⭕
</ExcelTable>

- 選択肢ごとに列が増えるため、Excelでのフィルタリングや集計が容易になります
- 選ばれなかった選択肢もCSVから確認可能です
- 選択肢が多い場合、列数が増えすぎてしまい、視覚的に見づらくなる可能性があります

### 列展開をOFFにして出力した例

{/* prettier-ignore */}
<ExcelTable>
日付, OS, , ,
2022/01/01, Windows, , ,
2022/01/02, Mac, , ,
2022/01/03, iOS, , , \_
</ExcelTable>

- 1列でデータを表現するためコンパクトにまとまります
- データシート全体のファイルサイズを抑えられます
- バックアップ用や、単純な一覧表示、または他のシステムへデータをインポートする際に適しています

### 列の展開を個別に指定する

CSV出力設定では、一括で「展開」のON/OFFが適用されます。しかし、特定の入力フォームだけ展開を変えたい場合は、テンプレートの編集画面から個別に設定することが可能です。

![CSV出力設定よりこちらのほうが優先される](./img/template-setting_tablet.png)

テンプレートでの設定が優先して適用され、その後にCSV出力設定が適用されます。これにより、日報の種類や分析の目的に合わせて、より柔軟な出力形式を実現できます。

### CSVで出力不可能な項目について

- [バイナリ関係のデータ](/nipoplus/template/binarys)（写真、署名、ファイル）はCSVのセル内に直接出力することはできません
- CSV上には「CSV出力不可」と表示されます
- CSV出力設定から「写真・ファイル等を出力」の項目をONにすることでまとめてダウンロードできます
