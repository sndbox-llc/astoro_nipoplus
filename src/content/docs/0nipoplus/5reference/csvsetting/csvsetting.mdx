---
slug: nipoplus/reference/csvsettings
title: ⚙️CSV出力の設定
description: csv
sidebar:
  label: ⚙️CSV出力の設定
---

import ExcelTable from '@components/ExcelTable.astro'

NipoPlusでは、日報に記録されたデータをCSV形式で出力する際に、出力の形式を細かくカスタマイズできます。
CSVファイルは、ExcelやGoogleスプレッドシートでの詳細な分析、他のシステムへのデータインポート、または長期的なデータバックアップなど、様々な用途で活用されます。

それぞれのCSVファイルの用途に応じて設定を変更することで、手動でのデータ加工の手間を大幅に削減し、データ分析の効率を向上させることができます。

出力設定は「CSV出力」ボタンの隣りにある「▼」ボタンから行えます。設定の内容は自動で保存されます。

![CSV出力のオプション設定はON/OFFの切り替えで簡単に設定可能](./img/csv-setting1_tablet.png)

## 列の展開について - データ分析の形式をカスタマイズ

CSV出力設定における「列の展開」は、数値や選択肢のデータをCSV上でどのように表示するかを決定します。この設定により、特定の分析やピボットテーブル作成に適した形式を選択できます。

「列の展開」がOFFの場合、データは1つの列にまとめて表示されます。ONにすると、各項目ごとに列が増えて表示されます。

以下は、[選択入力（単一選択）フォーム](/nipoplus/template/selects/#plain)をCSV出力したときのイメージです。選択肢は「Windows, Mac, Android, iOS」があるとします。

### 列展開をOFFにして出力した例 - バックアップや一覧性に優れる

{/* prettier-ignore */}
<ExcelTable>
日付, OS, , ,
2022/01/01, Windows, , ,
2022/01/02, Mac, , ,
2022/01/03, iOS, , , \_
</ExcelTable>
1つのデータ項目が1列（上記の例ではB列）にまとめて出力されます。
特徴：

- 1列でデータを表現するため、コンパクトにまとまり、視覚的な一覧性に優れます
- データシート全体のファイルサイズを抑えられます
- バックアップ用や、単純な一覧表示、または他のシステムへデータをインポートする際に適しています

### 列展開をONにして出力した例 - 詳細分析やピボットテーブルに最適

{/* prettier-ignore */}
<ExcelTable>
日付, 【OS】Windows, 【OS】Mac, 【OS】Android, 【OS】iOS
2022/01/01, ⭕, -, -, -
2022/01/02, -, ⭕, -, -
2023/01/03, -, -, -, ⭕
</ExcelTable>
選択肢やサブ項目ごとに列が増えて出力されます（上記の例ではB〜E列）。例えば、製造業の点検項目で「異常なし」「軽微な異常」「要修理」といった選択肢をそれぞれ独立した列として出力することで、各状態の発生回数をカウントしやすくなります。
特徴：

- 選択肢ごとに列が増えるため、Excelでのフィルタリングや集計、ピボットテーブル作成が容易になります
- 他の選択肢もCSV上で確認できるため、詳細なデータ分析を行う際に非常に便利です
- 品質管理のチェックシートや設備点検の項目別データを分析する際に、この形式が重宝されます

### 【列の展開】を個別に指定する - テンプレートからの詳細設定

CSV出力設定では、一括で「展開」のON/OFFが適用されます。しかし、特定の入力フォームだけ展開を変えたい場合は、テンプレートの編集画面から個別に設定することが可能です。

![CSV出力設定よりこちらのほうが優先される](./img/template-setting_tablet.png)

テンプレートでの設定が優先して適用され、その後にCSV出力設定が適用されます。これにより、日報の種類や分析の目的に合わせて、より柔軟な出力形式を実現できます。

## その他の設定項目 - 細やかなニーズに対応

以下に、CSV出力に関するその他の設定項目をまとめて記載します。これらを調整することで、さらに細やかなニーズに対応したデータ出力が可能です。

<dl class="basic">

<dt>行列を入れかえる</dt>
<dd>
  <ul>
    <li>OFF：1行に1つの日報（日報、点検記録）のデータを表示します（推奨）。一般的なCSVの形式です。</li>
    <li>ON：1列に1つの日報のデータを表示します。データが非常に多く、行方向の比較が必要な特殊な分析や、特定のデータ分析ツールへのインポートに適しています。</li>
  </ul>
</dd>

<dt>日付の古い順に出力する</dt>
<dd>
  <ul>
    <li>OFF：日報の日付が新しい順に出力されます（最新のデータが上に来ます）。</li>
    <li>ON：日報の日付が古い順に出力されます。時系列分析や、データの開始時点から追跡したい場合に便利です。</li>
  </ul>
</dd>

<dt>写真・ファイル等を出力</dt>
<dd>
  <a href="/nipoplus/template/binarys/#picture">写真入力フォーム</a>、<a href="/nipoplus/template/binarys/#sign">署名入力フォーム</a>、<a href="/nipoplus/template/binarys/#file">ファイル入力フォーム</a>で添付されたデータをCSVファイルとは別のフォルダにまとめて出力します。また、ダウンロード形式がZIPに変化します。現場写真の証拠保全や、添付資料の一括管理に役立ちます。
</dd>

<dt>コメントを出力</dt>
<dd>
  日報に書き込まれた<a href="/nipoplus/staff/readreport/#comment">コメント</a>をCSVファイルに含めます。日報本文だけでなく、そこでのやり取りも含めて分析したい場合に有効です。
</dd>

<dt>提出日を出力</dt>
<dd>日報の提出日時をCSVファイルに含めます。日報作成者が指定した日付です</dd>

<dt>【可変-提出日】同日報の2行目以降も出力</dt>
<dd>
  <ul>
    <li>
      ON：<a href="/nipoplus/template/array/">反復入力フォーム</a>を使用している日報で、2行目以降のデータにも日付を重複して出力します。
    </li>
    <li>OFF：反復入力の2行目以降は日付を省略します。</li>
  </ul>
  <a href="/nipoplus/template/array/">反復入力</a>がない場合、この設定は意味を持ちません。時系列データの詳細な分析において、日付が各行に明示されていると便利です。
</dd>

<dt>提出者IDを出力</dt>
<dd>日報を作成したスタッフのシステム内部IDを出力します。他のシステムとのデータ連携に利用する場合があります</dd>

<dt>提出者名を出力</dt>
<dd>日報を作成したスタッフ名を出力します</dd>

<dt>
  <a href="/nipoplus/staff/readreport/">状態</a>
  を出力
</dt>
<dd>日報の現在の状態（承認・棄却・新規・進行・修正のいずれか）をCSVに含めます。日報の承認状況をまとめて把握したい場合に便利です</dd>

<dt>URLを出力</dt>
<dd>出力元の日報のURLをCSVファイルに含めます。これにより、CSVデータから直接NipoPlusの日報にアクセスし、元の日報内容やコメントなどを確認できます</dd>

<dt>
  <a href="/nipoplus/reference/reportstate/#agree">承認者名</a>
  を出力
</dt>
<dd>
  日報を承認するスタッフの名前と、承認・棄却の状態を出力します。<a href="/nipoplus/reference/reportstate/#relay">承認者が複数人いる場合</a>は、人数分列が追加されて出力されます。承認フローの履歴を詳細に分析したい場合に有効です。
</dd>

<dt>文書IDを出力</dt>
<dd>日報固有のIDを出力します（システム内部で自動的に割り当てられる20文字程度の文字列）。他のデータベースとの連携や、日報のユニーク識別子として利用できます</dd>

<dt>文書番号を出力</dt>
<dd>日報に自動で割り振られる連番を出力します。日報の管理番号として利用できます</dd>
</dl>

### CSVで出力不可能な項目について

[バイナリ関係のデータ](/nipoplus/template/binarys/)（写真、署名、ファイル）はCSVのセル内に直接出力することはできません。CSV上には「CSV出力不可」と表示されます。
これらのデータは、CSV出力設定から「写真・ファイル等を出力」の項目をONにすることで、CSVファイルとは別のフォルダにファイルとしてまとめてダウンロードできます。
