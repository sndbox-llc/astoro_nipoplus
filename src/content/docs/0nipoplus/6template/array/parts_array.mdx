---
slug: nipoplus/template/array
title: 🧩反復入力フォーム - 複数行・繰り返し発生する作業や記録の管理に
description: NipoPlusの反復入力フォームは、日報の作業時間記録、製造工程の進捗記録、設備点検の項目別記録など、繰り返し発生するデータを行単位で自由に増やして入力できるテンプレートパーツです。可変行の表形式で、作業内容や点検結果を効率的に記録・管理し、業務の標準化とデータの一覧性を高めます。
sidebar:
  label: 🧩反復入力
---

import ExcelTable from '@components/ExcelTable.astro'

## 反復入力フォームとは？ - 繰り返し発生する記録を効率化

「反復入力」という名前だけではイメージしにくいかもしれませんが、これは日々の業務で繰り返し発生する記録を、行数を自由に増やしながら入力できるフォームです。
例えば、次のような日報をイメージしてください。

![日報の作業内容、設備点検の項目別記録、製造工程の進捗など、繰り返し発生するデータを表形式で効率的に入力可能](./img/array_tablet.webp)

「作成者」や「天候」といった項目は固定ですが、その下にある「時刻、分類、生産数」といった表（上の図でいうと赤枠で囲まれた部分）は、日報作成の都度、行数が変わります。このような「行が可変する表形式」のフォームを、NipoPlusでは反復入力フォームで実装できます。

反復入力フォーム自体は「行」の枠組みを提供し、その各列には、[文字入力フォーム](/nipoplus/template/text/)や[数値入力フォーム](/nipoplus/template/digital/)など、他の様々な入力フォームを埋め込んで設計します。これにより、日報の時系列作業記録、製造ラインでの複数製品の検査結果、巡回点検での項目ごとの状況記録など、柔軟な表形式のデータ入力を実現します。

## 反復入力の初期設定

前述の通り、反復入力フォームは単体では機能しないため、反復入力を追加後に、その中に入力フォーム（各列の項目）を追加していきます。

![反復入力の設定は、反復フォームの中に使用する項目（列）を追加して行う](./img/template_tablet.png)

以下は本入力フォームにのみ存在する設定項目です。

<dl class="basic">
  <dt>入力切替を無効にする</dt>
  <dd>これがONの場合、日報作成時に入力方式（ラジオ・プルダウン）を変更するボタンが表示されなくなります。画面をスッキリさせたいときはONにしてください。</dd>
  <dt>入力必須</dt>
  <dd>これがONの場合、反復入力の行がすべて空欄だと日報の提出ができません。必須の作業記録や点検項目が未入力になるのを防ぐ際に設定します。</dd>
  <dt>初期の行数</dt>
  <dd>日報作成時に反復入力を生成する行数です。初期値は1です。定型的な業務で、ある程度の行数が決まっている場合に設定すると便利です。</dd>
</dl>

補足：[共通設定事項](/nipoplus/editor/template/#common_setting)もご確認ください。

反復入力フォームを含んだテンプレートを使って[日報を書く](/nipoplus/reference/inputmethod/#array)ときの画面は次のように見えます。

## 反復の日報を表示

反復入力で記録されたデータは、一覧画面で視覚的に分かりやすく表示されます。偶数行と奇数行で色が互い違いに表示されるため、視認性が高く、複数行のデータも読みやすいのが特徴です。

![偶数行は水色の背景で表示される](./img/post_tablet.png)

受信画面では、表示形式を表形式・カード形式の2種類から切替が可能です。業務内容や閲覧デバイスに合わせて最適な表示を選べます。

## 反復の日報をCSVに出力する

反復入力の中で使用されている入力フォームがCSV出力に対応していれば、そのデータもCSV出力が可能です。
CSVは通常1行に1件のデータを表す形式ですが、反復入力は1件の日報の中に複数行のデータが格納されるため、CSV出力の形式は以下のようになります。

反復入力の行数に合わせて、提出者名などのヘッダー情報（日報共通の情報）が2行目以降空欄で出力されます。これは、1つの日報が複数の行にわたるデータを持つことを示しています。

{/* prettier-ignore */}
<ExcelTable>
提出日, 状態, 文書ID, 承認者1, 作成者, 【晴れ】天候, 【雨】天候, 【自】時間, 【至】時間, 【休憩】時間, 【正常】分類, 【稼働停止】分類, 【メンテナンス】分類, 生産数（個）
2023/1/19 11:57, 進行, Ij2Lhek, 管理者A, Nipoアリス, ⭕, -, 8:00, 11:00, ⭕, -, ⭕, , 5
, , , , , , , 12:30, 16:30, -, -, ⭕, , 0
, , , , , , , 18:00, 20:00, ⭕, -, -, , 2
</ExcelTable>

このCSVデータを活用することで、日報の作業時間合計、生産ラインごとの実績集計、点検項目ごとの集計など、詳細なデータ分析を行うことができます。

## 反復の日報をPDFに出力する

反復入力で作成された日報はPDF出力にも対応しています。
注意点として、反復の列数が多すぎるとPDFに出力する際にレイアウトが崩れる可能性があります。
基本的には、テンプレートの設計と同様に、反復入力内の各フォームの幅の合計が12（NipoPlusのグリッドシステム）に収まるように設計すると、レイアウトがはみ出しにくくなります。
これにより、日報の作業履歴や点検記録を、見やすいPDF形式で出力し、関係者への共有や長期保存に活用できます。
