---
slug: excel/sales_report
title: 1ヶ月分の日報を1枚のエクセルにして集計する
description: NipoPlusの集計機能で効率的なデータ集計が可能ですが、より高度な分析やグラフ作成を行いたい場合は、エクセルを使った集計がおすすめです。本記事では、NipoPlusの集計機能とエクセルを使った集計方法について解説します。
sidebar:
  label: 1ヶ月分の日報を1枚のエクセルにして集計する
---

import ExcelTable from '@components/ExcelTable.astro'

NipoPlus上で集計やグラフを作ることが可能です。こちらの記事でできることを紹介しています。

[分析はこちら](/tips/analytics/)
[集計はこちら](/nipoplus/staff/charts/)

アプリからの集計は手軽で便利ですが、できることにどうしても限りがあります。より細かな集計や分析がしたい場合は日報のデータをCSVに出力してエクセル上から集計や分析を行うことが可能です。

## 1ヶ月分の日報をまとめてCSV出力

今回は下図のような営業日報を例に見ていきましょう。

![CSV出力するレポートのサンプル](./img/sample-report_tablet.png)

日報は日別に提出されるためそのままでは集計に不向きです。上の図でも1件のレポートであり、集約されていません。
毎日、日報からエクセルに必要なデータを書き写すような作業をしていませんか？
これはあまりにも非効率です。NipoPlusでは期間を指定してワンクリックで1ヶ月分の日報をCSVでダウンロードできます。

![1ヶ月分のレポートをまとめてCSVに出力する](./img/csv-export_tablet.png)

:::note[CSV = Excelでは有りませんがCSVはエクセルでそのまま開けます]
:::

## CSV出力されたレポートをエクセルで開く

ダウンロードしたCSVファイルをダブルクリックで開きます。PCにエクセルがインストールされていればエクセルで起動します。

:::note[エクセルが起動しない？]
エクセルで起動しないときはファイルの関連付けが誤っている可能性があります。PCの設定をご確認ください
:::

CSVファイルがエクセルで次のように表示されます。

{/* prettier-ignore */}
<ExcelTable>
提出日, 提出者名, 承認者1, 承認者1詳細, 移動手段, 活動エリア, 【件】訪問件数, 【件】約定件数, 業務内容
2023/06/13 11:54, アルバイトXY, AdminA, 未処理, B社用車, その他, 1, 0,
2023/06/13 11:54, AdminA, AdminA, 未処理, 公共交通機関, 市街地, 5, 1, これはサンプルです
2023/06/10 11:54, 浅生, AdminA, 未処理, A社用車, ビル内, 2, 1,
2023/06/07 11:54, 浅生, AdminA, 未処理, A社用車, 郊外, 5, 1,
2023/06/05 11:54, 浅生, AdminA, 未処理, B社用車, 郊外, 11, 2,
2023/06/04 11:54, AdminA, AdminA, 未処理, その他, その他, 1, 1, 出張でハワイへ
2023/06/03 11:54, 浅生, AdminA, 未処理, 公共交通機関, 郊外, 22, 1,
2023/06/02 11:54, AdminA, AdminA, 未処理, A社用車, 市街地, 11, 3,
2023/06/01 11:54, 浅生, AdminA, 未処理, A社用車, 市街地, 5, 1, -
</ExcelTable>

なおCSVの項目は出力オプションで変更可能です。文書IDや提出者IDなど不要な項目は出力OFFにすることで見た目をスッキリさせることができます。
詳しくはCSV出力オプション設定を御覧ください

[CSV出力設定についてはこちら](/nipoplus/reference/csvsettings/)

CSV出力を使えばこのようにたくさんのバラバラなレポートを1枚のエクセルにまとめ、その後の様々な集計や分析が簡単に行えるようになります。
テンプレートに沿ってフィールド分け（列が分かれる）されるので、集計や並べかえにも簡単にできます。

---

さてここからはNipoPlusではなくエクセル機能の紹介になります。
いくつか代表的な集計技法を見ていきましょう

### 訪問件数と契約件数から契約率を算出する

【約定件数÷訪問件数＝約定率】

このような計算式をエクセルに入力することで約定率を求めることができます。

1. 作業用に1列挿入
1. 挿入した列に計算式を入力（この例ではH2/G2）
1. 入力した式を末尾まで複写

![訪問の件数と約定件数から約定率を計算する](./img/work1.png)

これで約定率を求めることができました。

:::note[NipoPlusの算術フォームを使って計算することもできます]
:::

### 各列の合計を求める（Sum関数）

エクセル入門で最初に習う関数ですのでご存知の方も多いでしょう。

1. 合計を取りたい範囲を選択
1. オートサム（Σアイコン）をクリック
1. 合計値が計算される

![各列の合計を求めるにはSum関数を使う](./img/work2.png)

これで1ヶ月分の日報の合計が求められました。

:::note[1ヶ月の集計はNipoPlusのアプリ内でも集計可能です]
:::

### 移動手段の回数をカウントする（Countif関数）

1. 計算用のセルを用意し、移動手段の単語を書いておく
1. Countif関数を使い単語を参照させる式を書く
1. 式を複写する

移動手段を数えてみましょう。車は何回？公共交通機関は何回？こういう計算はCountif関数を使います。
計算式を複写したいので絶対参照という機能を使っています。

![出現した選択肢の単語回数を数える](./img/work3.png)

詳しい式は上の画像を参照してください。これでA車両が4回、B車両が2回使われたとわかります。

:::note[単語の集計はNipoPlusのアプリ内でも可能です]
:::

### 活動エリアが「その他」の行を塗りつぶす（条件付き書式）

特定の行だけ目立たせたいときってありますよね。条件付き書式を使って設定できます。

1. データのある範囲を全て選択する
1. 条件付き書式をクリックし、ユーザ定義のルールに切り替える
1. ルールに「$f2="その他"」と入力する

この辺になると知らない方も多いのでは？条件に一致する行を塗りつぶして目立たせることができます。

![条件付き書式を使い特定の行を赤く塗る](./img/work4.png)

同じ要領で訪問件数が一定数以下なら塗るといったことも可能です。
こういう機能はエクセル独壇場です。

### 特定のスタッフのレポートだけ抽出する

エクセルのフィルタ機能を使い、提出者が「浅生」のレポートだけ抜き出してみましょう

1. リボンから「データ」「フィルター」をクリック
1. 提出者の列にある▼をクリック
1. 条件を指定する
1. 条件に一致した行のみ出力される

![フィルタを使い特定のスタッフの書いたレポートのみ抽出する](./img/work5.png)

:::note[subtotal関数を使えば浅生の訪問件数合計を取得するといった計算も可能です]
:::

### 訪問件数の多い順に並べ替えをする

エクセルの並べかえを使えば簡単にデータの多い順、少ない順に並べ替えできます

1. 並べ替えたい列をアクティブセルにする
1. メニューから「並べかえ」をクリック
1. アクティブセルを基準に並べ替えが行われる

![指定した列で並べ替え](./img/work6.png)

:::caution[合計行があると合計も並べ替えされるので注意してください]
:::

---

## 【エクセルの集計】＋【NipoPlusの入力の手軽さ】＝効率化

ここまでいくつか便利なエクセルテクニックを紹介してきました。
ここで紹介した機能はエクセルのもつほんの一部に過ぎません。便利な機能がまだまだたくさん有ります。

しかし分析をするにしてもデータを1枚のエクセルシートにまとめる必要があるわけです。日報は毎日、様々なスタッフから作成されます。これを1枚のエクセルシートにまとめるのが本当に大変です。
NipoPlusを使えば、このデータの用意と書き手の不安を同時に解決できます。

- レポートき手はスマホやタブレットで手軽に入力が可能になる
- 読み手はアプリから日報を読み、承認ができる
- 集計者はワンクリックでデータを1枚のエクセルにまとめられる

三者三様、それぞれの立場をよしなに繋げてくれるNipoPlusを是非使ってみてください。
